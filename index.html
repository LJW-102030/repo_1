<script>
    const listElement = document.getElementById('package-list');
    
    // 指向 info 資料夾下的清單
    fetch('info/package.list?t=' + new Date().getTime())
        .then(res => {
            if (!res.ok) throw new Error("找不到 info/package.list");
            return res.text();
        })
        .then(text => {
            const packages = text.split('\n')
                                 .map(name => name.trim())
                                 .filter(name => name.length > 0 && !name.includes('<'));

            if (packages.length === 0) {
                listElement.innerHTML = "<li>[提示] 倉庫清單目前為空。</li>";
                return;
            }

            listElement.innerHTML = '';
            packages.forEach(name => {
                const li = document.createElement('li');
                li.className = 'pkg-item';
                // 下載連結依然指向 packages/ 資料夾
                li.innerHTML = `<span>> ${name}.aip</span><a href="packages/${name}.aip" class="download-btn">GET</a>`;
                listElement.appendChild(li);
            });
        })
        .catch(err => {
            listElement.innerHTML = `<li style="color:red;">[錯誤] ${err.message}</li>`;
        });
</script>
